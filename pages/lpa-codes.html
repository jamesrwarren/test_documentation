<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>LPA Codes</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

            <meta property="og:type" content="article"/>
            <meta property="og:title" content="LPA Codes"/>
            <meta property="og:url" content="https://jamesrwarren.github.io/test_documentation/pages/lpa-codes.html"/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://jamesrwarren.github.io/test_documentation/theme/css/bootstrap.min.css" type="text/css"/>
        <link rel="stylesheet" href="https://jamesrwarren.github.io/test_documentation/theme/css/style.css">  
    <link href="https://jamesrwarren.github.io/test_documentation/theme/css/font-awesome.min.css" rel="stylesheet">
    <!--link href="https://jamesrwarren.github.io/test_documentation/theme/css/pygments.css" rel="stylesheet"-->
    <link href="https://jamesrwarren.github.io/test_documentation/theme/css/prism.css" rel="stylesheet" />
  
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://code.jquery.com/jquery.js"></script>
    <link rel="stylesheet" type="text/css" href="jquery.pageslide.css">


</head>
<body>

<div class="wrap">
    <div class="container">
        <div class="row">
            <div class="col-sm-8 col-md-8 col-lg-9 col-xs-12">

    <section id="content" class="body">
        <h1 class="entry-title">LPA Codes</h1>
        <div class="entry-content">
            <h4>Purpose</h4>
<p>The LPA code generator is an endpoint used by Sirius and Use an LPA application to 
generate, validate and revoke codes so that actors, 
such as individuals with legal power of attorney over a donor, 
can validate their identity and gain access to view a donors details.</p>
<p>This is accomplished by Sirius sending out letters with unique codes to actors who can then 
try and validate the code through the use an LPA website.</p>
<h4>Consumers of this API</h4>
<ul>
<li>Sirius - <a href="https://github.com/ministryofjustice/opg-sirius">opg-sirius</a></li>
<li>Use an LPA - <a href="https://github.com/ministryofjustice/opg-use-an-lpa">opg-use-an-lpa</a></li>
</ul>
<h4>Integration Repositories</h4>
<ul>
<li>LPA Codes - <a href="https://github.com/ministryofjustice/opg-data-lpa-codes">opg-data-lpa-codes</a></li>
</ul>
<h4>Integration Location</h4>
<ul>
<li>Sirius Account (development, preproduction, production)</li>
<li>EU West 1</li>
</ul>
<h4>Security</h4>
<p>URLs to the endpoints are publicly accessible but locked down by AWS Authentication to only 
be accessible from the task ECS role of the API service for both Sirius and Use an LPA. </p>
<h4>Setup Local Environment</h4>
<p>From the root of the repository you can type <code>docker-compose up -d</code>. This will bring up two services, 
a connexion service (that mocks aws gateway validation and routes requests) and a dynamodb local service 
which acts as the data store.</p>
<h4>Setup Branch Environment</h4>
<p>Branch environments are set up through the CI pipeline. However if you wish to build one manually 
for whatever reason then you can run the following (replacing <myworkspace> with whatever you want 
your workspace to be called):</p>
<div class="highlight"><pre><span></span><code><span class="err">cd terraform/environment</span>
<span class="err">export TF_WORKSPACE=&lt;myworkspace&gt;</span>
<span class="err">aws-vault exec identity -- terraform init</span>
<span class="err">aws-vault exec identity -- terraform plan</span>
<span class="err">aws-vault exec identity -- terraform apply  </span>
</code></pre></div>


<p>More information on working with workspaces can be found in the technologies used tab.</p>
<h4>ADRs</h4>
<p>Can be found <a href="https://github.com/ministryofjustice/opg-data-lpa-codes/tree/master/docs/architecture/decisions">here</a> 
and <a href="https://github.com/ministryofjustice/opg-data/tree/master/docs/architecture">here</a>.</p>
<h4>Testing</h4>
<p>Testing is accomplished by using a combination of unit tests and contract testing (using pact).</p>
<p>Unit tests can be run locally by running the following from the root directory of the repo:</p>
<div class="highlight"><pre><span></span><code><span class="err">virtualenv venv</span>
<span class="err">source venv/bin/activate</span>
<span class="err">pip install -r ./lambda_functions/v1/requirements/dev-requirements.txt</span>
<span class="err">python -m pytest</span>
</code></pre></div>


<p>Pact tests can only be run against pact broker currently. Local verification.</p>
<h4>Design Documents</h4>
<p><a href="https://docs.google.com/drawings/d/1ghTX_lBpWcjYViPCzbbXQ0MRa2bcg2o0xf25GLSbAgI/edit">work in progress</a></p>
        </div>
    </section>
            </div>
            <div class="col-sm-4 col-md-4 col-lg-3 col-xs-12">
                <ul class="nav nav-pills nav-stacked">
                    <li><a class="btn btn-default" href="https://jamesrwarren.github.io/test_documentation/index.html">Home</a></li>
                    <li>
                        <a class="btn btn-default" href="https://jamesrwarren.github.io/test_documentation/archives.html">Archives</a>
                    </li>
                </ul><hr />


<div class="panel panel-primary">
    <div class="panel-heading">
        ~ Follow me ~
    </div>
    <div class="panel-body">
        <a href="https://www.publicguardian-scotland.gov.uk/general/contact-us"><img
            class= "social-icon" src="https://jamesrwarren.github.io/test_documentation/theme/images/OPG Contact Us-icon.png"></img>
        </a>
    </div>
</div>


<div class="panel panel-primary">
    <div class="panel-heading">
        ~ Interesting Links ~
    </div>
    <div class="panel-body">
        <li class="list-group-item"><a href="https://github.com/ministryofjustice/opg-data">OPG Data
        </a></li>
        <li class="list-group-item"><a href="https://github.com/ministryofjustice/opg-data-deputy-reporting">OPG Data Deputy Reporting
        </a></li>
        <li class="list-group-item"><a href="https://github.com/ministryofjustice/opg-data-lpa-codes">OPG Data LPA Codes
        </a></li>
        <li class="list-group-item"><a href="http://getpelican.com/">Pelican
        </a></li>
        <li class="list-group-item"><a href="http://python.org/">Python.org
        </a></li>
        <li class="list-group-item"><a href="http://jinja.pocoo.org/">Jinja2
        </a></li>
    </div>
</div>

                    
            </div>
        </div>
        <hr class="hidden-xs"/>
        <div class="row">
            <div class="footer">
                <div class="container">
                    <p class="footnote">Â©Christine Doig. Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</i></a>. Thanks to <a href="http://twitter.github.com/bootstrap/">Bootstrap</i></a>, <a href="http://subtlepatterns.com/">Subtle Patterns</i></a> and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome.</a><a href="https://github.com/chdoig/pelican-bootstrap3-lovers">Lovers Theme</a> by Christine Doig
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://jamesrwarren.github.io/test_documentation/theme/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="jquery.pageslide.min.js"></script>
<script src="https://jamesrwarren.github.io/test_documentation/theme/js/prism.js"></script>
<script>function validateForm(query)
    {return (query.length > 0);}
</script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://jamesrwarren.github.io/test_documentation/theme/js/respond.min.js"></script>
</body>
</html>